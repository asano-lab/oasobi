var SVGGraphNonStrict=function(){function toFunction(source,paramName,Math,mathjs,svg){var func,m=Math;with(Math)eval("func = function("+paramName+"){return "+mathjs(source)+";};");return func}function toValue(source,Math,mathjs,svg){if("number"==typeof source||source instanceof Object)return source;if(null!=source&&""!=source){var result,m=Math;with(Math)eval("result = "+mathjs(source)+";");switch(typeof result){case"string":case"number":case"boolean":break;default:if(result instanceof Array)break;throw"TypeError:"+source+" is not available."}return result}}return{toFunction:toFunction,toValue:toValue}}();Object.freeze(SVGGraphNonStrict);var SVGGraph=function(){"use strict";var isSVGAvailable=!!document.createElementNS&&void 0!==document.createElementNS("http://www.w3.org/2000/svg","svg").viewBox;if(isSVGAvailable){var SVG_NS="http://www.w3.org/2000/svg",XHTML_NS="http://www.w3.org/1999/xhtml",elemCache={},templates={},Math=function(){var obj={};function push(arr){for(var i=0,len=arr.length;i<len;i++)obj[arr[i]]=window.Math[arr[i]]}return push(["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"]),push(["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","imul","log","max","min","pow","random","round","sin","sqrt","tan"]),obj}(),_Macro={},_pre=function(){},_post=function(){},Marker={none:getElem("rect")};registerMarker(getElem("polygon",{points:"-5,0 -3,5 -5,10 5,5"}),"arrow","warrow"),registerMarker(getElem("circle",{cx:"5",cy:"5",r:"4"}),"dot","circle"),registerMarker(getElem("polygon",{points:"5,0 10,5 5,10 0,5"}),"dia","wdia");var rgexCRLF=new RegExp("\r\n|\n","g"),show=eachAction((function(elem){elem.style.display=""})),hide=eachAction((function(elem){elem.style.display="none"})),readOnly=eachAction((function(elem){elem.readOnly=!0})),editable=eachAction((function(elem){elem.readOnly=!1})),markerCount=0;!function(proto){function caseViewport(svg,me){var size;setSize(svg,getViewportSize(svg),me)}function caseNested(svg,me){var width=getAttr(svg,"width",0),height=getAttr(svg,"height",0),vpSize=getViewportSize(svg),size;setSize(svg,{width:0==width?vpSize.width:width,height:0==height?vpSize.height:height},me)}function getViewportSize(svg){var vp=svg.viewportElement?svg.viewportElement:svg,style=window.getComputedStyle(vp),width=1*style.width.replace(/px/,""),height=1*style.height.replace(/px/,"");return 0!=width&&0!=height||(width=getAttr(vp,"width",200),height=getAttr(vp,"height",200)),{width:width,height:height,viewBox:svg.getAttribute("viewBox")}}function setSize(svg,size,me){me.width=size.width,me.height=size.height,me.setRange(-me.width/2,me.width/2,-me.height/2,me.height/2),null==svg.getAttribute("viewBox")&&svg.setAttribute("viewBox",[0,0,me.width,me.height].join(" "))}function check(me){if(me.minX>=me.maxX)throw"parameter error:maxX must be grater than minX.";if(me.minY>=me.maxY)throw"parameter error:maxY must be grater than minY."}function getAttr(svg,name,defaultValue){var value=svg.getAttribute(name);return null!=value?1*value.split("px")[0]:defaultValue}function round(value){return window.Math.round(100*value)/100}proto.init=function(svg){svg.viewportElement?caseNested(svg,this):caseViewport(svg,this),this.script=svg.script().replace(/\{\{(\d)\}\}/g,"(svg.param($1))")},proto.slideX=0,proto.slideY=0,proto.setRange=function(minX,maxX,minY,maxY){Object.defineProperty(this,"minX",{get:function(){return minX-this.slideX/this.unitX},configurable:!0}),Object.defineProperty(this,"maxX",{get:function(){return maxX-this.slideX/this.unitX},configurable:!0}),Object.defineProperty(this,"minY",{get:function(){return minY+this.slideY/this.unitY},configurable:!0}),Object.defineProperty(this,"maxY",{get:function(){return maxY+this.slideY/this.unitY},configurable:!0}),this.unitX=this.width/window.Math.abs(maxX-minX),this.unitY=this.height/window.Math.abs(maxY-minY),check(this)},proto.posX=function(x){return round((x-this.minX)*this.unitX)},proto.posY=function(y){return round(this.height-(y-this.minY)*this.unitY)},proto.graphX=function(x){return round(x/this.unitX+this.minX)},proto.graphY=function(y){return round((this.height-y)/this.unitY+this.minY)},proto.scaleX=function(x){return round(x*this.unitX)},proto.scaleY=function(y){return round(y*this.unitY)}}(graphSetting.prototype),document.addEventListener("DOMContentLoaded",main,!0);var mathjs=function(str){return str},obj;return obj={},obj.registerMath=registerMath,obj.registerMacro=registerMacro,obj.registerMarker=registerMarker,obj.registerConverter=registerConverter,obj.registerPresetting=registerPresetting,obj.registerPostsetting=registerPostsetting,Object.defineProperty(obj,"mathjs",{get:function(){return mathjs}}),obj.Math=Math,obj}function cacheElem(name,elem){for(var attrs=elem.attributes,i=attrs.length-1;i>=0;i--){var attr=attrs[i];"d"==attr.name?elem.setAttribute(attr.name,"M0,0"):(elem.setAttribute(attr.name,""),elem.removeAttribute(attr.name))}var list=elemCache[name];list||(list=[],elemCache[name]=list),list.push(elem)}function getElem(name,attributes){var result,freeList=elemCache[name];if(freeList&&freeList.length>0&&(result=freeList.pop()),!result){var template=templates[name];template||(template=document.createElementNS(SVG_NS,name),templates[name]=template),result=template.cloneNode(!1)}return result.setAttribute("auto-created","true"),insertAttributes(result,attributes)}function getXHTMLElem(name,attributes){var elem=document.createElementNS(XHTML_NS,name);return elem.setAttribute("auto-created","true"),insertAttributes(elem,attributes)}function insertAttributes(elem,attributes){if(attributes)for(var i in attributes)elem.setAttribute(i,attributes[i]);return elem}function registerMath(name,f){var m=Math;if("function"==typeof f){var g,s="g="+f.toString()+";";eval(s),Math[name]=g}else Math[name]=f}function registerMacro(name,f){_Macro[name]=f}function registerPresetting(f){_pre=f}function registerPostsetting(f){_post=f}function registerMarker(source,blackCaseName,whiteCaseName){var elem;void 0!==blackCaseName&&void 0!==whiteCaseName&&(elem="string"==typeof source?getElem("path",{d:source}):source.cloneNode(!1),Marker[blackCaseName]=elem,Marker[whiteCaseName]=elem.cloneNode(!1),elem.isBlackCase=!0)}function toHPos(pos){switch(pos){case"topLeft":case"left":case"bottomLeft":case"tl":case"l":case"bl":case"lt":case"lb":return"left";case"top":case"center":case"bottom":case void 0:case"t":case"c":case"b":return"center";case"topRight":case"right":case"bottomRight":case"tr":case"r":case"br":case"rt":case"rb":return"right";default:return"left"}}function toVPos(pos){switch(pos){case"topLeft":case"top":case"topRight":case"tl":case"t":case"tr":case"lt":case"rt":return"top";case"left":case"center":case"right":case void 0:case"l":case"c":case"r":return"middle";case"bottomLeft":case"bottom":case"bottomRight":case"bl":case"b":case"br":case"lb":case"rb":return"bottom";default:return"top"}}function main(){for(var svgs=document.querySelectorAll("svg[script]:not([graph])"),i=0,len=svgs.length;i<len;i++){var svg;setup(svgs[i])}}function setup(svg){setupStyle(svg),extendAPI(svg),drawGraph(svg),extendAnimAPI(svg),extendOutputAPI(svg),addMouseEvent(svg),addDragEvent(svg),createGUI(svg)}function setupStyle(svg){svg.style.overflow="hidden";var script=svg.getAttribute("script"),vp;script=script.replace(rgexCRLF,"\r"),svg.setAttribute("script",script),(svg.viewportElement?svg.viewportElement:svg).setAttribute("graph","graph")}function extendAPI(svg){var initialParams=[10],currentParams=[10];svg.param=function(i,value){if(!(i>=10))return void 0===value?currentParams[i]:(value instanceof String&&(value=null!==value?value.split(";")[0]:null),void(currentParams[i]=SVGGraphNonStrict.toValue(value,Math,mathjs,svg)))};for(var i=0;i<10;i++)svg.param(i,svg.getAttribute("param"+i)),initialParams[i]=currentParams[i];svg.params=function(){for(var i=0,len=arguments.length;i<len&&i<10;i++)svg.param(i,arguments[i])};var initialScript=svg.getAttribute("script"),currentScript=initialScript;svg.script=function(src){if(void 0===src)return currentScript;currentScript=src},svg.reset=function(){currentScript=initialScript;for(var i=0;i<10;i++)currentParams[i]=initialParams[i];svg.update()}}function extendOutputAPI(svg){function removeAttributes(elem){removeAttribute(elem,"script"),removeAttribute(elem,"mode"),removeAttribute(elem,"graphX"),removeAttribute(elem,"graphY"),removeAttribute(elem,"anim"),removeAttribute(elem,"dur"),removeAttribute(elem,"freeze");for(var i=0;i<10;i++)removeAttribute(elem,"param"+i),removeAttribute(elem,"label"+i)}function removeAttribute(elem,name){elem.setAttribute(name,""),elem.removeAttribute(name)}function getStyleElem(){var htmlStyle=document.querySelector("style.SVGGraph"),style=getElem("style");return htmlStyle&&(style.textContent=htmlStyle.textContent),style}function getDefinitionElem(){var svg=document.querySelector("svg.SVGGraph"),df=document.createDocumentFragment();if(svg){var clone=svg.cloneNode(!0);clone.setAttribute("style",""),clone.style.visibility="hidden",df.appendChild(clone)}return df}svg.getSource=function(type,needScript){var vp=svg.viewportElement?svg.viewportElement:svg,cloned=vp.cloneNode(!0);if(removeAttributes(cloned),!needScript)for(var elems=cloned.querySelectorAll("svg"),i=0,len=elems.length;i<len;i++){var elem;removeAttributes(elems[i])}cloned.insertBefore(getStyleElem(),cloned.firstChild),cloned.insertBefore(getDefinitionElem(),cloned.firstChild);var style=window.getComputedStyle(vp);null===vp.getAttribute("width")&&cloned.setAttribute("width",style.width),null===vp.getAttribute("height")&&cloned.setAttribute("height",style.height);var serializer,source=(new XMLSerializer).serializeToString(cloned);switch(source='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n'+(source=source.replace(/^<svg(?!.+xmlns.+>)/,'<svg xmlns="http://www.w3.org/2000/svg"')),type){case"string":return source;case"encoded":return encodeURIComponent(source);case"dataScheme":return"data:image/svg+xml,"+encodeURIComponent(source);case"blob":return new Blob([source],{type:"image/svg+xml"});case"url":default:try{var blob=new Blob([source],{type:"image/svg+xml"});return URL.createObjectURL(blob)}catch(e){return"data:image/svg+xml,"+encodeURIComponent(source)}}}}function extendAnimAPI(svg){var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(func){setTimeout(func,100)};function translate(params){for(var i=0,len=params.length;i<len;i++){var param=params[i];param instanceof Array&&(1==param.length?params[i]=param[0]:(param[0]=SVGGraphNonStrict.toValue(param[0],Math,mathjs,svg),param[1]=SVGGraphNonStrict.toValue(param[1],Math,mathjs,svg)))}}svg.anim=function(params,dur,freeze){if((void 0===dur||dur<=0)&&(dur=5),!svg.animating){translate(params);var start=(new Date).getTime();svg.animating=!0,frame()}function frame(){try{var current,msec,rate=((new Date).getTime()-start)/(1e3*dur);rate<1?(rate=window.Math.min(rate,1),set(rate=window.Math.max(rate,0)),requestAnimationFrame(frame)):(svg.animating=void 0,set(freeze?1:0))}catch(e){throw svg.animating=void 0,e}}function set(rate){for(var i=0,len=params.length;i<len;i++){var param=params[i];if(param instanceof Array){var s=param[0],e=param[1];svg.param(i,s+(e-s)*rate)}else svg.param(i,param)}svg.update(!0)}}}function createGUI(svg){placeGUI(svg),setVisibility(svg),registerBtnEvents(svg)}function placeGUI(svg){var elems={inputs:[],spans:[]},div=getXHTMLElem("div",{class:"gui"});elems.div=div;var ta=getXHTMLElem("textarea",{wrap:"off"});elems.textarea=ta,ta.textContent=svg.script(),div.appendChild(ta);for(var i=0;i<10;i++){var span=getXHTMLElem("span"),labelText=svg.getAttribute("label"+i);labelText?labelText.match(/\{\{p\}\}/)||(labelText+=":{{p}}"):labelText="p"+i+":{{p}}";var param=svg.getAttribute("param"+i);param||(param=""),param=param.replace(/"/g,"&quot;"),span.innerHTML=labelText.replace(/\{\{p\}\}/,'<input type="text" value="'+param+'"/>');var input=span.querySelector("input");elems.inputs[i]=input,elems.spans[i]=span,div.appendChild(span)}var bf=getXHTMLElem("span",{class:"buttons"});elems.btnUpdate=getButton("更新"),elems.btnReset=getButton("復元"),elems.btnStart=getButton("開始"),elems.lnkSave=getLink("保存"),elems.btnPng=getButton("画像"),div.appendChild(bf);var vp=svg.viewportElement?svg.viewportElement:svg;function getButton(value){var elem=getXHTMLElem("input",{type:"button",value:value});return bf.appendChild(elem),elem}function getLink(value){var link=getXHTMLElem("a",{href:"",target:"_blank"});return link.textContent=value,bf.appendChild(link),link}vp.parentNode.insertBefore(div,vp.nextSibling),svg.elems=elems}function eachAction(f){var g=function(elem){elem instanceof Array?elem.forEach(g):f(elem)};return g}function setVisibility(svg){var flags=svg.getAttribute("mode"),elems=svg.elems;if(flags){show(elems.div),readOnly(elems.textarea),readOnly(elems.inputs),hide(elems.btnUpdate),hide(elems.btnReset),flags.match(/w/)&&(editable(elems.textarea),editable(elems.inputs),show(elems.btnUpdate),show(elems.btnReset)),(flags.match(/s/)?show:hide)(elems.textarea),(flags.match(/p/)?show:hide)(elems.spans),(flags.match(/l/)?show:hide)(elems.lnkSave),(flags.match(/a/)?show:hide)(elems.btnStart),flags.match(/a/)&&"true"==svg.getAttribute("freeze")&&show(elems.btnReset),(flags.match(/i/)?show:hide)(elems.btnPng);for(var i=0;i<10;i++)svg.getAttribute("param"+i)||hide(elems.spans[i])}else hide(elems.div)}function registerBtnEvents(svg){var elems=svg.elems,prevSource;function clearErr(input){input.removeAttribute("errored"),input.title=""}elems.btnUpdate.addEventListener("click",(function(){svg.script(elems.textarea.value);for(var errored=!1,i=0;i<10;i++){var input=elems.inputs[i];clearErr(input);try{svg.param(i,input.value)}catch(e){input.title=e,input.setAttribute("errored","errored"),errored=!0}}errored||svg.update()}),!1),elems.btnReset.addEventListener("click",(function(){elems.textarea.value=elems.textarea.textContent;for(var i=0;i<10;i++){var input=elems.inputs[i];clearErr(input),input.value=input.getAttribute("value")}svg.reset()}),!1),elems.lnkSave.addEventListener("mousedown",(function(e){try{URL.revokeObjectURL(prevSource)}catch(e){}var source=svg.getSource("url");prevSource=source,elems.lnkSave.href=source}),!1),window.navigator.msSaveBlob&&elems.lnkSave.addEventListener("mousedown",(function(e){var blob=svg.getSource("blob");window.navigator.msSaveOrOpenBlob(blob,"graph.svg")}),!1),elems.btnStart.addEventListener("click",(function(){for(var params=[],i=0;i<10;i++){var input=elems.inputs[i];clearErr(input);var value=input.value;params[i]=value.split(";")}var dur=svg.getAttribute("dur");(null===dur||dur<=0)&&(dur=5);var freeze=!!svg.getAttribute("freeze");try{svg.anim(params,dur,freeze)}catch(e){alert(e)}}),!1),elems.btnPng.addEventListener("click",(function(){var svgsource=svg.getSource("dataScheme"),img=getXHTMLElem("img"),canvas=getXHTMLElem("canvas");img.onload=function(){canvas.width=img.width,canvas.height=img.height;var ctx=canvas.getContext("2d");try{ctx.drawImage(img,0,0);var png=canvas.toDataURL()}catch(e){return void alert("png形式への変換に失敗しました．")}window.open(png,"_blank")},img.src=svgsource}),!1)}function addMouseEvent(svg){setPosition(0,0);var point=svg.createSVGPoint(),f=function(e){point.x=e.clientX,point.y=e.clientY;var ctm,inverse=svg.getScreenCTM().inverse(),p=point.matrixTransform(inverse);setPosition(p.x,p.y)},id=svg.id,selector='div[graph="'+id+'"],span[graph="'+id+'"],text[graph="'+id+'"],tspan[graph="'+id+'"]',display=document.querySelector(selector);function setPosition(x,y){var gX=svg.graphX(x),gY=svg.graphY(y);svg.setAttribute("graphX",gX),svg.setAttribute("graphY",gY),display&&null!==id&&""!=id&&(display.textContent="("+gX+","+gY+")")}svg.addEventListener("mousemove",f,!1),svg.getGraphX=function(){return svg.getAttribute("graphX")},svg.getGraphY=function(){return svg.getAttribute("graphY")}}function addDragEvent(svg){var mode=svg.getAttribute("mode");if(mode&&mode.match(/m/)){svg.addEventListener("dragstart",(function(e){e.preventDefault()}),!1),svg.style.cursor="pointer";var sx=0,sy=0,x=0,y=0;svg.addEventListener("mousedown",(function(e){0==e.button&&(sx=e.clientX,sy=e.clientY,svg.style.cursor="move",svg.addEventListener("mousemove",move,!1))}),!1),svg.addEventListener("mouseup",dragEnd,!1),svg.addEventListener("dblclick",(function(e){confirm("元に戻します．よろしいですか?")&&(svg.slide(0,0),x=0,y=0,svg.update())}),!1)}function dragEnd(e){x+=e.clientX-sx,y+=e.clientY-sy,svg.style.cursor="pointer",svg.removeEventListener("mousemove",move,!1)}function move(e){svg.slide(e.clientX-sx+x,e.clientY-sy+y),svg.update()}}function drawGraph(svg){var style,mStyle,tStyle,aStyle,setting=new graphSetting,Macro=translateMacro(),f,pre,post,funcCache={},callback=function(){},cp={};function extendAPI(){svg.update=main,svg.graphX=function(svgX){return setting.graphX(svgX)},svg.graphY=function(svgY){return setting.graphY(svgY)},svg.posX=function(x){return setting.posX(x)},svg.posY=function(y){return setting.posY(y)},svg.scaleX=function(width){return setting.scaleX(width)},svg.scaleY=function(height){return setting.scaleY(height)},svg.setCallback=function(f){callback=f},svg.slide=function(x,y){setting.slideX=x,setting.slideY=y},svg.clear=clear,svg.commands=function(commandName){var func=eval(commandName);return func},svg.macros=function(macroName){return Macro[macroName]}}function main(repeating){var h;for(var i in initStyle(),clear(),cp)delete cp[i];try{h=svg.suspendRedraw(1e3);var m=Math;repeating||(setting.init(svg),funcCache={},eval("pre = "+_pre.toString()),eval("f = function(){"+setting.script+"\n\r};"),eval("post = "+_post.toString())),pre(),f(),post()}catch(e){var t=getElem("text",{x:0,y:20,fontSize:20});t.textContent=e,svg.appendChild(t),svg.setAttribute("title",e)}finally{svg.unsuspendRedraw(h)}callback(svg,cp)}function initStyle(){style={fill:"none",stroke:"black",strokeWidth:1},mStyle={size:10,color:"inherit",fill:"white"},tStyle={fontStyle:"normal",fontSize:13},aStyle={axisStroke:"black",axisWidth:2,gridStroke:"darkGray",gridWidth:1,indexSize:10}}function translateMacro(){var _macro={},m=Math;for(var i in _Macro){var f=_Macro[i],source=f.toString(),g,s="g = "+source;eval(s),_macro[i]=g}return _macro}function setRange(xMin,xMax,yMin,yMax){xMin=fix(xMin),xMax=fix(xMax),yMin=fix(yMin),yMax=fix(yMax),setting.setRange(xMin,xMax,yMin,yMax),clear()}function setRangeAsRect(x,y,width,height){x=fix(x),y=fix(y),setRange(x,x+(width=fix(width)),y,y+(height=fix(height)))}function plot(func,from,to,pCount,markerStart,markerEnd){var result;return path(functionToPoints(func,from,to,pCount),!1,markerStart,markerEnd)}function area(func,from,to,pCount){var result=functionToPoints(func,from,to,pCount);result.unshift([result[0][0],0]),result.push([result[result.length-1][0],0]);var p=path(result);return p.style.stroke="none",append(p),p}function getFunc(source,paramName){var id=source+":"+paramName,func=funCache[id];return func||(func=SVGGraphNonStrict.toFunction(source,paramName,Math,mathjs,svg),funcCache[id]=func),func}function translateFunc(func){var f,g;return func instanceof Function?(f=function(x){return x},g=func):"string"==typeof func?(f=function(x){return x},g=SVGGraphNonStrict.toFunction(func,"x",Math,mathjs,svg)):func instanceof Array&&(func[0]instanceof Function?f=func[0]:"string"==typeof func[0]&&(f=SVGGraphNonStrict.toFunction(func[0],"t",Math,mathjs,svg)),func[1]instanceof Function?g=func[1]:"string"==typeof func[1]&&(g=SVGGraphNonStrict.toFunction(func[1],"t",Math,mathjs,svg))),{fx:f,fy:g}}function getPoints(funcs,params){var point,points=[];if(!params)return[];for(var i=0,len=params.length;i<len;i++)isValid((point=getPoint(funcs,params[i]))[0])&&isValid(point[1])&&points.push(point);return points;function isValid(value){return!isNaN(value)&&window.Math.abs(value)!=1/0}}function getPoint(funcs,t){return[funcs.fx(t),funcs.fy(t)]}function functionToPoints(func,from,to,pCount){from=fix(from,setting.minX),to=fix(to,setting.maxX),(null==pCount||pCount<=0)&&(pCount=1e3);for(var funcs=translateFunc(func),params=[],i=0;i<=pCount;i++)params.push(from+(to-from)/pCount*i);return getPoints(funcs,params)}function surface(fxSource,fySource,sFrom,sTo,tFrom,tTo,freq,pCount){sFrom=fix(sFrom,setting.minX),sTo=fix(sTo,setting.maxX),tFrom=fix(tFrom,setting.minY),tTo=fix(tTo,setting.maxY),(null==freq||freq<=0)&&(freq=5),(null==pCount||pCount<=0)&&(pCount=300);var g=getElem("g",{class:"surface"}),pfx=SVGGraphNonStrict.toFunction(fxSource,"s,t",Math,mathjs,svg),pfy=SVGGraphNonStrict.toFunction(fySource,"s,t",Math,mathjs,svg),fx,fy,i,points,p,gs=getElem("g",{class:"sfixed"});for(i=0;i<=freq;i++)points=functionToPoints([fx=getSFixed(pfx,sFrom+(sTo-sFrom)/freq*i),fy=getSFixed(pfy,sFrom+(sTo-sFrom)/freq*i)],tFrom,tTo,pCount),gs.appendChild(path(points,!1));g.appendChild(integrateStyle(gs));var gt=getElem("g",{class:"tfixed"});for(i=0;i<=freq;i++)points=functionToPoints([fx=getTFixed(pfx,tFrom+(tTo-tFrom)/freq*i),fy=getTFixed(pfy,tFrom+(tTo-tFrom)/freq*i)],sFrom,sTo,pCount),gt.appendChild(path(points,!1));return g.appendChild(integrateStyle(gt)),append(g);function getSFixed(f,sValue){return function(t){return f(sValue,t)}}function getTFixed(f,tValue){return function(s){return f(s,tValue)}}}function line(x1,y1,x2,y2,markerStart,markerEnd){x1=fix(x1,0),y1=fix(y1,0),x2=fix(x2,0),y2=fix(y2,0);var l=getStyledElem("line");return l.x1.baseVal.value=setting.posX(x1),l.y1.baseVal.value=setting.posY(y1),l.x2.baseVal.value=setting.posX(x2),l.y2.baseVal.value=setting.posY(y2),treatMarker(append(l),markerStart,markerEnd)}function iline(x1,y1,x2,y2){return _line(!0,x1,y1,x2,y2)}function hline(x1,y1,x2,y2,markerStart){return _line(!1,x1,y1,x2,y2,markerStart)}function _line(isFull,x1,y1,x2,y2,markerStart){if(x1=fix(x1,0),y1=fix(y1,0),x2=fix(x2,0),y2=fix(y2,0),x1==x2&&y1==y2)return line(x1,y1,x2,y2);var sy,ey;if(x1==x2)return y1<y2?(sy=setting.minY,ey=setting.maxY):(sy=setting.maxY,ey=setting.minY),isFull?line(x1,sy,x1,ey):line(x1,y1,x1,ey,markerStart);var slope=(y2-y1)/(x2-x1),slice=(y1+y2-(x1+x2)*slope)/2,sx,ex;return x1<x2?(sx=setting.minX,ex=setting.maxX):(sx=setting.maxX,ex=setting.minX),isFull?line(sx,slope*sx+slice,ex,slope*ex+slice):line(x1,y1,ex,slope*ex+slice,markerStart)}function slope(x,y,rad,length,markerStart,markerEnd){return _slope(line,x,y,rad,length,markerStart,markerEnd)}function islope(x,y,rad){return _slope(iline,x,y,rad,1)}function hslope(x,y,rad,markerStart){return _slope(hline,x,y,rad,1,markerStart)}function _slope(func,x,y,rad,length,markerStart,markerEnd){return x=fix(x,0),y=fix(y,0),rad=fix(rad,0),func(x,y,x+(length=fix(length,1))*Math.cos(rad),y+length*Math.sin(rad),markerStart,markerEnd)}function path(points,isClosed,markerStart,markerEnd){if("string"==typeof points&&(points=str(points)),!(points.length<2)){for(var p=getStyledElem("path"),values=[],i=0,len=points.length;i<len;i++){var point=points[i];values.push(setting.posX(fix(point[0],0))),values.push(setting.posY(fix(point[1],0)))}return p.setAttribute("d","M"+values.join(",")+(isClosed?"z":"")),treatMarker(append(p),markerStart,markerEnd)}}function turtle(x,y,commands,isClosed,markerStart,markerEnd){x=fix(x,0),y=fix(y,0);var cRad=0,points=[];points.push([x,y]);for(var i=0,len=commands.length;i<len;i++)for(var command=commands[i],rad=fix(command[0],0),length=fix(command[1],0),times=fix(command[2],1),div=fix(command[3],0),j=0;j<times;j++)cRad+=rad,x+=Math.cos(cRad)*length,y+=Math.sin(cRad)*length,points.push([x,y]),length+=div;return path(points,isClosed,markerStart,markerEnd)}function circle(cx,cy,r){cx=fix(cx,0),cy=fix(cy,0),r=fix(r,1);var c=getStyledElem("circle");return c.cx.baseVal.value=setting.posX(cx),c.cy.baseVal.value=setting.posY(cy),c.r.baseVal.value=setting.scaleX(r),append(c)}function ellipse(cx,cy,rx,ry){cx=fix(cx,0),cy=fix(cy,0),rx=fix(rx,1),ry=fix(ry,1);var e=getStyledElem("ellipse");return e.cx.baseVal.value=setting.posX(cx),e.cy.baseVal.value=setting.posY(cy),e.rx.baseVal.value=setting.scaleX(rx),e.ry.baseVal.value=setting.scaleY(ry),append(e)}function getArcFunc(cx,cy,rx,ry){return cx=fix(cx,0),cy=fix(cy,0),["cos(t)*"+(rx=fix(rx,1))+"+"+cx,"sin(t)*"+(ry=fix(ry,1))+"+"+cy]}function arc(cx,cy,rx,ry,from,to,markerStart,markerEnd){var func,pCount;return from=fix(from,0),to=fix(to,2*window.Math.PI),treatMarker(plot(getArcFunc(cx,cy,rx,ry),from,to,Math.floor(Math.abs(from-to)/Math.PI*180)),markerStart,markerEnd)}function pie(cx,cy,rx,ry,from,to){from=fix(from,0),to=fix(to,2*window.Math.PI);var func,pCount,points=functionToPoints(getArcFunc(cx,cy,rx,ry),from,to,Math.floor(Math.abs(from-to)/Math.PI*180));return points.unshift([cx,cy]),path(points,!0)}function rect(x,y,width,height,rx,ry){x=fix(x,0),y=fix(y,0),width=fix(width,1),height=fix(height,1),rx=fix(rx,0),ry=fix(ry,0);var r=getStyledElem("rect");return width>=0?(r.x.baseVal.value=setting.posX(x),r.width.baseVal.value=setting.scaleX(width)):(r.x.baseVal.value=setting.posX(x+width),r.width.baseVal.value=setting.scaleX(-width)),height>=0?(r.y.baseVal.value=setting.posY(y)-setting.scaleY(height),r.height.baseVal.value=setting.scaleY(height)):(r.y.baseVal.value=setting.posY(y),r.height.baseVal.value=setting.scaleY(-height)),r.rx.baseVal.value=setting.scaleX(rx),r.ry.baseVal.value=setting.scaleY(ry),append(r)}function horizon(y){return line(setting.minX,y,setting.maxX,y)}function vertical(x){return line(x,setting.minY,x,setting.maxY)}function textSingleLine(x,y,str,pos,fontSize){var tA;x=fix(x,0),y=fix(y,0);var fSize=void 0===fontSize?tStyle.fontSize:fontSize,dy;switch(toHPos(pos)){case"left":tA="start";break;case"center":tA="middle";break;case"right":tA="end"}switch(toVPos(pos)){case"top":dy=fSize;break;case"middle":dy=fSize/2;break;case"bottom":dy=0}var t=getElem("text",{x:setting.posX(x),y:setting.posY(y)+dy-2}),style;return applyStyle(t,tStyle),t.style.fontSize=fSize+"px",t.style.textAnchor=tA,t.textContent=str,append(t)}function text(x,y,str,pos){var ln=(str=fixStr(str,"")).split("\n"),len=ln.length;if(1==len)return textSingleLine(x,y,str,pos);var g=getElem("g"),dPosStart,fSize=tStyle.fontSize;switch(isNaN(fSize)&&(fSize=16),toVPos(pos)){case"top":dPosStart=0;break;case"middle":dPosStart=-fSize/2*(len-1);break;case"bottom":dPosStart=-fSize*(len-1)}for(var i=0;i<len;i++){var t=textSingleLine(x,y,ln[i],pos,fSize);t.setAttribute("transform","translate(0, "+(dPosStart+fSize*i)+")"),g.appendChild(t)}return g.className.baseVal="text",append(g)}function treatMarker(elem,markerStart,markerEnd){return void 0!==markerStart&&"none"!=markerStart&&appendMarker(elem,markerStart,!1),void 0!==markerEnd&&"none"!=markerEnd&&appendMarker(elem,markerEnd,!0),elem}function appendMarker(elem,markerStyle,isEnd){var params,marker=getElem("marker",{id:"marker_auto_created_"+markerCount++,markerUnits:"userSpaceOnUse",markerWidth:mStyle.size,markerHeight:mStyle.size,viewBox:"0 0 10 10",overflow:"visible",refX:"5",refY:"5",orient:"auto"});return marker.appendChild(getMarkerShape(markerStyle)),append(marker),elem.style[isEnd?"markerEnd":"markerStart"]="url(#"+marker.id+")",elem}function getMarkerShape(markerStyle){var shapeTemplate=Marker[markerStyle];void 0===shapeTemplate&&(shapeTemplate=getElem("rect"));var shape=shapeTemplate.cloneNode(!1);return shapeTemplate.isBlackCase?(shape.style.fill=getMarkerColor(),shape.style.stroke="none"):(shape.style.fill=mStyle.fill,shape.style.stroke=getMarkerColor()),shape.style.strokeDasharray="",shape.className.value="marker",shape;function getMarkerColor(){return"inherit"==mStyle.color?style.stroke:mStyle.color}}function dot(x,y,markerStyle,format){var sx=x,sy=y;x=fix(x,0),y=fix(y,0),markerStyle=fixStr(markerStyle,"dot"),format=fixStr(format,"");var posX=setting.posX(x),posY=setting.posY(y),marker=getMarkerShape(markerStyle),scale=mStyle.size/10;marker.setAttribute("transform","translate("+posX+","+posY+"),scale("+scale+","+scale+"),translate(-5,-5)"),append(marker);var str=format.replace(/\{\{x\}\}/g,x).replace(/\{\{y\}\}/g,y).replace(/\{\{sx\}\}/g,sx).replace(/\{\{sy\}\}/g,sy),slide=mStyle.size/2,text=textSingleLine(x,y,str,"top");text.setAttribute("transform","translate(0,"+slide+")");var g=getElem("g");return g.appendChild(marker),g.appendChild(text),g.className.baseVal="dot",append(g)}function dots(ds,markerStyle,format){"string"==typeof ds&&(ds=str(ds));for(var g=getElem("g"),i=0,len=ds.length;i<len;i++){var d=ds[i];g.appendChild(dot(d[0],d[1],markerStyle,format))}g.className.baseVal="dots",append(g)}function distance(gridStyle,d,max,skip){if(!svg.querySelector("g.axisSet")){gridStyle=fixStr(gridStyle,"full"),d=fix(d,1),max=fix(max,10),skip=fix(skip,0);for(var fsize=aStyle.indexSize,i,elem,style,g=getElem("g",{class:"axisSet"}),gGrid=getElem("g",{class:"grid"}),gAxis=getElem("g",{class:"axis"}),gIndex=getElem("g",{class:"index"}),i=1;i*d<=max;i++){switch(style=(elem=ellipse(0,0,i*d,i*d)).style,gridStyle){case"dashed":style.strokeDasharray="5";case"full":default:style.stroke=aStyle.gridStroke,style.strokeWidth=aStyle.gridWidth}gGrid.appendChild(elem),i%(skip+1)==0&&((elem=textSingleLine(i*d,0,i*d+"","top",fsize)).style.fontSize=fsize,gIndex.appendChild(elem))}return integrateStyle(gGrid),gIndex.setAttribute("transform","translate(0,2)"),integrateStyle(gIndex),g.appendChild(gAxis),(style=(elem=line(0,0,setting.maxX,0)).style).shapeRendering="crispEdges",style.stroke=aStyle.axisStroke,style.strokeWidth=aStyle.axisWidth,g.appendChild(gGrid),g.appendChild(gAxis),g.appendChild(gIndex),append(g)}}function axis(gridStyle,dx,dy,skipX,skipY){if(!svg.querySelector("g.axisSet")){var minX,maxX,minY,maxY,setGridStyle;switch(dx=fix(dx,0),dy=fix(dy,0),gridStyle=fixStr(gridStyle,"none"),skipX=fix(skipX,-1),skipY=fix(skipY,-1),gridStyle){case"short":var len=4/setting.scaleX(1);minX=-len,maxX=len,minY=-len,maxY=len,setGridStyle=function(elem){return elem};break;case"full":minX=setting.minX,maxX=setting.maxX,minY=setting.minY,maxY=setting.maxY,setGridStyle=function(elem){return elem};break;case"dashed":minX=setting.minX,maxX=setting.maxX,minY=setting.minY,maxY=setting.maxY,setGridStyle=function(elem){return elem.style.strokeDasharray="5,5",elem};break;default:setGridStyle=function(){}}var gGrid=getElem("g",{class:"grid"}),l;if("none"!=gridStyle){var i;if(dx>0)for(i=setting.minX-setting.minX%dx;i<=setting.maxX;i+=dx)gGrid.appendChild(line(i,minY,i,maxY));if(dy>0)for(i=setting.minY-setting.minY%dy;i<=setting.maxY;i+=dy)gGrid.appendChild(line(minX,i,maxX,i))}integrateStyle(gGrid),setGridStyle(setStyle(gGrid));var gAxis=getElem("g",{class:"axis"});gAxis.appendChild(line(setting.minX,0,setting.maxX,0)),gAxis.appendChild(line(0,setting.minY,0,setting.maxY)),integrateStyle(gAxis),setStyle(gAxis,!0);var ind=index(dx,dy,skipX,skipY),g=getElem("g",{class:"axisSet"});return g.appendChild(gGrid),g.appendChild(gAxis),g.appendChild(ind),append(g)}function setStyle(elem,isAxis){var s=elem.style;return s.shapeRendering="crispEdges",isAxis?(s.stroke=aStyle.axisStroke,s.strokeWidth=aStyle.axisWidth):(s.stroke=aStyle.gridStroke,s.strokeWidth=aStyle.gridWidth),elem}}function index(dx,dy,skipX,skipY){var i,x,y,len,fsize=aStyle.indexSize,g=getElem("g",{class:"index"}),gx=getElem("g",{class:"x"}),gy=getElem("g",{class:"y"});if(skipX>=0){for(i=-1;;i--)if(x=i*dx*(skipX+1),!(setting.maxX<x)){if(x<setting.minX)break;gx.appendChild(textSingleLine(x,0,x+"","top",fsize))}for(i=1;;i++)if(!((x=i*dx*(skipX+1))<setting.minX)){if(setting.maxX<x)break;gx.appendChild(textSingleLine(x,0,x+"","top",fsize))}}if(gx.setAttribute("transform","translate(0,3)"),skipY>=0){for(i=-1;;i--)if(y=i*dy*(skipY+1),!(setting.maxY<y)){if(y<setting.minY)break;gy.appendChild(textSingleLine(0,y,y+"","right",fsize))}for(i=1;;i++)if(!((y=i*dy*(skipY+1))<setting.minY)){if(setting.maxY<y)break;gy.appendChild(textSingleLine(0,y,y+"","right",fsize))}}return gy.setAttribute("transform","translate(-3, 0)"),g.appendChild(integrateStyle(gx)),g.appendChild(integrateStyle(gy)),append(g)}function title(str){var t=getElem("title");return t.textContent=str,append(t)}function desc(str){var d=getElem("desc");return d.textContent=str,append(d)}var shape=function(){function translate(seg,map){for(var i in map)void 0!==seg[i]&&(seg[i]=map[i](seg[i]))}function posX(x){return setting.posX(x)}function posY(y){return setting.posY(y)}function scaleX(x){return setting.scaleX(x)}function scaleY(y){return setting.scaleY(y)}function flipY(y){return-setting.scaleY(y)}function swf(sw){return 0==sw?1:0}function angle(a){return-a}var abs={x:posX,y:posY,x1:posX,y1:posY,x2:posX,y2:posY,rx:scaleX,ry:scaleY,sweepFlag:swf,angle:angle},rel={x:scaleX,y:flipY,x1:scaleX,y1:flipY,x2:scaleX,y2:flipY,rx:scaleX,ry:scaleY,sweepFlag:swf,angle:angle};return function(d){var p=getStyledElem("path");p.setAttribute("d",d);for(var segs=p.pathSegList,i=0,len=segs.numberOfItems;i<len;i++){var seg=segs.getItem(i);translate(seg,seg.pathSegType%2==0?abs:rel)}append(p)}}();function append(node){return svg.appendChild(node),node}function bg(node){var axis=svg.querySelector("g.axisSet");return svg.insertBefore(node,axis),node}function clear(){clearSvg(svg)}function getStyledElem(name){var elem;return applyStyle(getElem(name),style)}function val(expression,arrayOnly){var source=expression.replace(/,/g,'","').replace(/\[/g,'["').replace(/\]/g,'"]').replace(/"\[/g,"[").replace(/\]"/g,"]"),values;return eval("values = "+source+";"),arrayOnly?values:valArray(values)}function str(expression){return val(expression,!0)}function valArray(values){if(values instanceof Array){for(var i=0,len=values.length;i<len;i++){var a=values[i];values[i]=valArray(a)}return values}return toValue(values)}function toValue(expression){return SVGGraphNonStrict.toValue(expression,Math,mathjs,svg)}function fix(val,defaultVal){var result=toValue(val);return void 0===result||null==result?defaultVal:result}function fixStr(val,defaultVal){return void 0===val||null==val||val instanceof String&&""==val?defaultVal:val+""}extendAPI(),main()}function applyStyle(elem,style){var s=elem.style;for(var i in style){var value=style[i];void 0!==value&&""!=value&&(s[i]=value)}return elem}function integrateStyle(g){for(var i=0,len=g.childNodes.length;i<len;i++){var c=g.childNodes[i];if(0==i){var style=c.getAttribute("style");style?g.setAttribute("style",style):(style=c.getAttributeNS(SVG_NS,"style"),g.setAttributeNS(SVG_NS,"style",style))}c.setAttribute("style",""),c.removeAttribute("style")}return g}function clearSvg(svg){svg.removeAttribute("title");for(var nodes=svg.querySelectorAll("svg *[auto-created=true]"),i=0,len=nodes.length;i<len;i++){var node=nodes[i];node.parentNode.removeChild(nodes[i]),cacheElem(node.tagName,node)}}function graphSetting(svg){}function registerConverter(f){mathjs=f}}();Object.freeze(SVGGraph),function(){function mathjs(str){for((str=str.replace(/\s/g,"")).indexOf("^-1")>=0&&(str=str.replace(/(sin|cos|tan|sec|csc|cot|sinh|cosh|tanh|sech|csch|coth)\^-1/g,"a$1")),str=(str=(str=(str=(str=str.replace(/π/g,"(π)")).replace(/√/g,"rt")).replace(/(-?(?:\d+|\d*\.\d+))°/g,"rad($1)")).replace(/(^|\W)(\d*\.\d+|\d+)([A-Za-z\(])/g,"$1$2*$3")).replace(/\)(\w|\()/g,")*$1");str.indexOf("^")>=0;)str=replacePow(str);for(;str.indexOf("!")>=0;)str=replaceFactorial(str);return str}function replacePow(str){var p=str.lastIndexOf("^"),right=str.slice(p+1),left=str.substring(0,p),rightExp=getRightPart(right),leftExp=getLeftPart(left),result;return left.substr(0,left.length-leftExp.length)+"pow("+leftExp+","+rightExp+")"+right.slice(rightExp.length)}function replaceFactorial(str){var p=str.indexOf("!"),right=str.slice(p+1),left=str.substring(0,p),leftExp=getLeftPart(left),result;return left.substr(0,left.length-leftExp.length)+"factorial("+leftExp+")"+right}function getRightPart(str){var match=str.match(/^(?:-?(?:\d*\.\d+|\d+)|-?[A-Za-z]\w*(?:\.[A-Za-z]\w*)?|[A-Za-z]\w*)/),part=match?match[0]:"";if("("!=str.charAt(part.length))return part;for(var level=0,c,i=part.length,len=str.length;i<len&&("("==(c=str.charAt(i))&&level++,")"==c&&level--,0!=level);i++);return str.substr(0,i+1)}function getLeftPart(str){var numMatch=str.match(/([A-Za-z]\w*|[A-Za-z]\w*\.[A-Za-z]\w*|-?(?:\d*\.\d+|\d+))$/);if(numMatch)return numMatch[0];var i=str.length-1;if(")"==str.charAt(i)){for(var level=0,c;i>=0&&(")"==(c=str.charAt(i))&&level++,"("==c&&level--,0!=level);i--);i--}var remain,match=str.substring(0,i+1).match(/-?([A-Za-z]\w*(?:\.[A-Za-z]\w*)?|[A-Za-z]\w)*$/),a;return(match?match[0]:"")+str.slice(i+1)}SVGGraph.registerConverter(mathjs)}(),function(){var r=SVGGraph.registerMath;r("pi",Math.PI),r("Pi",Math.PI),r("pI",Math.PI),r("π",Math.PI),r("e",Math.E),r("ln2",Math.LN2),r("ln10",Math.LN10),r("log2e",Math.LOG2E),r("log10e",Math.LOG10E),r("sqrt2",Math.SQRT2),r("sqrt1_2",Math.SQRT1_2),r("not",(function(x){return!x})),r("rt",(function(x,a){return a=void 0===a?2:a,Math.pow(x,1/a)})),r("cbrt",(function(x){return Math.sign(x)*Math.rt(Math.abs(x),3)})),r("rad",(function(deg){return deg/180*Math.PI})),r("deg",(function(rad){return rad/Math.PI*180})),r("log",(function(x,a){return void 0===a&&(a=Math.E),window.Math.log(x)/window.Math.log(a)})),r("ln",(function(x){return window.Math.log(x)})),r("sec",(function(x){return 1/Math.cos(x)})),r("csc",(function(x){return 1/Math.sin(x)})),r("cot",(function(x){return 1/Math.tan(x)})),r("asec",(function(x){return Math.acos(1/x)})),r("acsc",(function(x){return Math.asin(1/x)})),r("acot",(function(x){return Math.atan(1/x)})),r("arcsin",(function(x){return Math.asin(x)})),r("arccos",(function(x){return Math.acos(x)})),r("arctan",(function(x){return Math.atan(x)})),r("arcsec",(function(x){return Math.asec(x)})),r("arccsc",(function(x){return Math.acsc(x)})),r("arccot",(function(x){return Math.acot(x)})),r("sinh",(function(x){return(Math.exp(x)-Math.exp(-x))/2})),r("cosh",(function(x){return(Math.exp(x)+Math.exp(-x))/2})),r("tanh",(function(x){return(Math.exp(x)-Math.exp(-x))/(Math.exp(x)+Math.exp(-x))})),r("sech",(function(x){return 1/Math.cosh(x)})),r("csch",(function(x){return 1/Math.sinh(x)})),r("coth",(function(x){return 1/Math.tanh(x)})),r("asinh",(function(x){return Math.log(x+Math.sqrt(x*x+1))})),r("acosh",(function(x){return Math.log(x+Math.sqrt(x*x-1))})),r("atanh",(function(x){return Math.log((1+x)/(1-x))/2})),r("asech",(function(x){return Math.acosh(1/x)})),r("acsch",(function(x){return Math.asinh(1/x)})),r("acoth",(function(x){return Math.atanh(1/x)})),r("arcsinh",(function(x){return Math.asinh(x)})),r("arccosh",(function(x){return Math.acosh(x)})),r("arctanh",(function(x){return Math.atanh(x)})),r("arcsech",(function(x){return Math.asech(x)})),r("arccsch",(function(x){return Math.acsch(x)})),r("arccoth",(function(x){return Math.acoth(x)})),r("sign",(function(x){return 0==x?0:x<0?-1:1})),r("factorial",(function(n){if(n<0)return NaN;if(0==n)return 1;for(var result=1,i=1;i<=n;i++)result*=i;return result})),r("P",(function(n,r){return Math.factorial(n)/Math.factorial(n-r)})),r("C",(function(n,r){return Math.P(n,r)/Math.factorial(r)})),r("floor",(function(x,n){void 0===n&&(n=0);var m=Math.pow(10,n);return window.Math.floor(x*m)/m})),r("round",(function(x,n){void 0===n&&(n=0);var m=Math.pow(10,n);return window.Math.round(x*m)/m})),r("ceil",(function(x,n){void 0===n&&(n=0);var m=Math.pow(10,n);return window.Math.ceil(x*m)/m}))}();